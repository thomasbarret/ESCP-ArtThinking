<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faceit - Swipe & Discover</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --popover: 0 0% 100%;
            --popover-foreground: 222.2 84% 4.9%;
            --primary: 0 100% 50%;
            --primary-foreground: 0 0% 98%;
            --secondary: 210 40% 96%;
            --secondary-foreground: 222.2 84% 4.9%;
            --muted: 210 40% 96%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 210 40% 96%;
            --accent-foreground: 222.2 84% 4.9%;
            --destructive: 0 100% 50%;
            --destructive-foreground: 210 40% 98%;
            --border: 214.3 31.8% 91.4%;
            --input: 214.3 31.8% 91.4%;
            --ring: 0 100% 50%;
            --radius: 0.75rem;
        }

        * {
            border-color: hsl(var(--border));
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #fd5068 0%, #ff6b6b 25%, #fd5068 50%, #ff6b6b 75%, #fd5068 100%);
            /* Utilisation de svh pour une meilleure compatibilit√© mobile */
            height: 100svh;
            overflow: hidden;
            color: hsl(var(--foreground));
        }

        .card {
            background-color: hsl(var(--card));
            color: hsl(var(--card-foreground));
            border: 1px solid hsl(var(--border));
            border-radius: calc(var(--radius) + 4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .swipe-card {
            position: absolute;
            width: 100%;
            height: 100%;
            cursor: grab;
            will-change: transform, opacity;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: translateX(0) rotate(0deg) scale(1);
            opacity: 1;
            transition: none;
        }

        .swipe-card:active {
            cursor: grabbing;
        }

        .swipe-card.dragging {
            transition: none !important;
        }

        .swipe-card.swiped-left {
            transform: translateX(-120%) rotate(-30deg) scale(1) !important;
            opacity: 0 !important;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        .swipe-card.swiped-right {
            transform: translateX(120%) rotate(30deg) scale(1) !important;
            opacity: 0 !important;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        .profile-image {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .gradient-overlay {
            background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.3) 50%, transparent 100%);
        }

        .action-button {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            border: none;
            cursor: pointer;
        }

        .action-button:hover {
            transform: scale(1.15);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.2);
        }

        .action-button:active {
            transform: scale(0.95);
        }

        .like-button {
            background: linear-gradient(135deg, #0fccb9, #22ffae);
            color: white;
        }

        .pass-button {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
        }

        .info-button {
            background: linear-gradient(135deg, #4dabf7, #339af0);
            color: white;
        }

        .upload-button {
            background: linear-gradient(135deg, #fd5068, #ff6b6b);
            color: white;
        }


        .modal {
            backdrop-filter: blur(12px);
            background: rgba(0, 0, 0, 0.6);
        }

        .modal-content {
            max-height: 90vh;
            overflow-y: visible;
        }

        .button-primary {
            background: linear-gradient(135deg, #fd5068, #ff6b6b);
            color: white;
            border: none;
            border-radius: var(--radius);
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: all 0.2s;
            cursor: pointer;
        }

        .button-primary:hover {
            background: linear-gradient(135deg, #ff4757, #ff6b6b);
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(253, 80, 104, 0.3);
        }

        .button-secondary {
            background: hsl(var(--secondary));
            color: hsl(var(--secondary-foreground));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
        }

        .button-secondary:hover {
            background: hsl(var(--accent));
        }

        .badge {
            background: linear-gradient(135deg, #fd5068, #ff6b6b);
            color: white;
            border-radius: calc(var(--radius) - 2px);
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            display: inline-flex;
            align-items: center;
        }

        .text-muted {
            color: hsl(var(--muted-foreground));
        }

        .upload-area {
            border: 2px dashed hsl(var(--border));
            border-radius: var(--radius);
            background: hsl(var(--muted) / 0.3);
            transition: all 0.3s;
        }

        .upload-area:hover {
            border-color: #fd5068;
            background: hsl(var(--muted) / 0.5);
        }

        .upload-area.dragover {
            border-color: #fd5068;
            background: rgba(253, 80, 104, 0.1);
        }

        .stats-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .purchase-item {
            transition: all 0.2s;
        }

        .purchase-item:hover {
            background: hsl(var(--muted) / 0.5);
            transform: translateX(4px);
        }

        .category-badge {
            background: linear-gradient(135deg, #fd5068, #ff6b6b);
            color: white;
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.25rem 0.5rem;
            border-radius: calc(var(--radius) - 4px);
        }

        .total-card {
            background: linear-gradient(135deg, #fd5068, #ff6b6b);
            color: white;
        }

        .total-card.high-spender {
            background: linear-gradient(135deg, #ffd700, #ffed4e, #ffd700);
            color: #1a1a1a;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), 0 0 60px rgba(255, 215, 0, 0.4), 0 0 90px rgba(255, 215, 0, 0.2);
            animation: highSpenderGlow 2s ease-in-out infinite alternate, highSpenderBounce 3s ease-in-out infinite;
            position: relative;
            overflow: hidden;
        }

        .total-card.high-spender::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s linear infinite;
            transform: rotate(45deg);
        }

        @keyframes highSpenderGlow {
            0% {
                box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), 0 0 60px rgba(255, 215, 0, 0.4), 0 0 90px rgba(255, 215, 0, 0.2);
            }
            100% {
                box-shadow: 0 0 40px rgba(255, 215, 0, 0.8), 0 0 80px rgba(255, 215, 0, 0.6), 0 0 120px rgba(255, 215, 0, 0.4);
            }
        }

        @keyframes highSpenderBounce {
            0%, 100% {
                transform: scale(1) translateY(-2px);
            }
            /* 25% {
                transform: scale(1.05) translateY(-2px);
            }
            50% {
                transform: scale(1.1) translateY(-4px);
            } */
            75% {
                transform: scale(1.05) translateY(-2px);
            }
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
            }
            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
            }
        }

        .high-spender-badge {
            animation: highSpenderPulse 0.5s ease-in-out infinite;
        }

        @keyframes highSpenderPulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.1);
                box-shadow: 0 0 0 10px rgba(255, 215, 0, 0);
            }
        }

        .swipe-card.hidden {
            display: none;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(253, 80, 104, 0.3);
            border-top: 3px solid #fd5068;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .heart-pulse {
            animation: heartPulse 2s ease-in-out infinite;
        }

        @keyframes heartPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .match-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2000;
            pointer-events: none;
        }

        .match-heart {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #fd5068, #ff6b6b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 20px 40px rgba(253, 80, 104, 0.4);
            animation: matchHeartPop 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .match-heart i {
            color: white;
            font-size: 48px;
            animation: heartBeat 0.6s ease-in-out 0.3s;
        }

        .match-text {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-top: 20px;
            color: white;
            font-size: 24px;
            font-weight: 800;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            animation: matchTextSlide 1s ease-out 0.4s both;
            white-space: nowrap;
            text-align: center;
        }

        @keyframes matchHeartPop {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.2);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.3); }
            50% { transform: scale(1.1); }
            75% { transform: scale(1.2); }
        }

        @keyframes matchTextSlide {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        /* Styles sp√©cifiques pour Safari sur iPhone */
        @supports (-webkit-touch-callout: none) {
            body {
                /* Utilisation de -webkit-fill-available pour une meilleure adaptation */
                height: -webkit-fill-available;
            }
            
            main {
                /* Ajustement de la hauteur pour √©viter que la barre Safari ne cache les boutons */
                min-height: calc(100svh - 120px);
                padding-bottom: env(safe-area-inset-bottom, 20px);
            }
            
            .action-buttons-container {
                /* Conteneur pour les boutons d'action avec padding de s√©curit√© */
                padding-bottom: env(safe-area-inset-bottom, 20px);
                background: transparent;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header-glass sticky top-0 z-40">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-red-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg">
                        <i data-lucide="heart" class="w-6 h-6 text-white heart-pulse"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold bg-gradient-to-r from-red-500 to-pink-500 bg-clip-text text-transparent">
                            Faceit
                        </h1>
                        <p class="text-sm text-gray-600 font-medium">Swipe & Discover</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-4 max-w-md h-screen flex flex-col">
        <!-- Instructions -->
        <div class="text-center mb-4 flex-shrink-0">
            <h2 class="text-2xl font-bold text-white mb-2 drop-shadow-lg">Discover Profiles</h2>
            <p class="text-white/90 text-base font-medium">Swipe right to like, left to pass</p>
        </div>

        <!-- Swipe Container -->
        <div class="relative flex-1 mb-4" id="swipeContainer">
            <!-- Cards will be inserted here -->
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-center items-center space-x-6 mb-4 flex-shrink-0">
            <button class="action-button pass-button" onclick="swipeLeft()" title="Pass">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>
            <button class="action-button info-button" onclick="showCurrentProfile()" title="View profile">
                <i data-lucide="shopping-cart" class="w-6 h-6"></i>
            </button>
            <button class="action-button like-button" onclick="swipeRight()" title="Like">
                <i data-lucide="heart" class="w-6 h-6"></i>
            </button>
        </div>

        <!-- Stats -->
        <div class="stats-card rounded-2xl p-4 text-center flex-shrink-0">
            <div class="grid grid-cols-3 gap-4 text-white">
                <div>
                    <div class="text-2xl font-bold" id="likesCount">0</div>
                    <div class="text-xs opacity-90 font-medium">Likes</div>
                </div>
                <div>
                    <div class="text-2xl font-bold" id="passesCount">0</div>
                    <div class="text-xs opacity-90 font-medium">Passes</div>
                </div>
                <div>
                    <div class="text-2xl font-bold" id="viewsCount">0</div>
                    <div class="text-xs opacity-90 font-medium">Views</div>
                </div>
            </div>
        </div>
    </main>

    <!-- Upload Modal -->
    <div id="uploadModal" class="fixed inset-0 modal z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="card p-8 w-full max-w-md">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold">Upload Your Photo</h3>
                    <button onclick="closeUploadModal()" class="text-gray-500 hover:text-gray-700 transition-colors">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
                
                <div class="upload-area p-12 text-center mb-6" id="uploadArea">
                    <i data-lucide="upload" class="w-16 h-16 mx-auto text-gray-400 mb-4"></i>
                    <p class="text-gray-600 mb-2 font-medium">Click or drag and drop</p>
                    <p class="text-sm text-muted">PNG, JPG up to 10MB</p>
                    <input type="file" id="fileInput" class="hidden" accept="image/*">
                </div>

                <button id="analyzeUploadBtn" class="button-primary w-full hidden">
                    <i data-lucide="brain" class="w-4 h-4 inline mr-2"></i>
                    Analyze this photo
                </button>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="fixed inset-0 modal z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="card w-full max-w-4xl modal-content">
                <div class="p-6 border-b">
                    <div class="flex justify-between items-center">
                        <h3 class="text-2xl font-bold">Profile & Purchase History</h3>
                        <button onclick="closeProfileModal()" class="text-gray-500 hover:text-gray-700 transition-colors">
                            <i data-lucide="x" class="w-6 h-6"></i>
                        </button>
                    </div>
                </div>
                
                <div id="profileContent" class="p-6">
                    <!-- Profile content will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Hardcoded profiles data
        const profiles = [
            {
                name: "Sylvain Bureau",
                age: 45,
                city: "Paris",
                image: "https://media.licdn.com/dms/image/v2/D4E03AQGsvBywZSQVpA/profile-displayphoto-shrink_400_400/profile-displayphoto-shrink_400_400/0/1710658954921?e=1761177600&v=beta&t=Ih43RRfVUGRDQH0BaClpHqhnwQjYoZstjk1LIzR0tXA",
                bio: "ESCP ART THINKING",
                job: "Unlearning specialist",
                profileId: 1
            },
            {
                name: "Marie Dubois",
                age: 28,
                city: "Paris",
                image: "https://i.imgur.com/SVEpHWD.jpeg",
                bio: "Innovation & Design Thinking",
                job: "Creative Director",
                profileId: 4
            },
            {
                name: "Mia Khalifa",
                age: 30,
                city: "Paris",
                image: "https://s.yimg.com/ny/api/res/1.2/gkVy_Ys1c2JGQZSNLSrSnQ--/YXBwaWQ9aGlnaGxhbmRlcjt3PTEyNDI7aD0xNjU2O2NmPXdlYnA-/https://media.zenfs.com/en/where_is_the_buzz_814/97f67efe728cb059ab0f897cac7ac140",
                bio: "Content Creator & Entrepreneur üíº",
                job: "Media Personality",
                profileId: 3
            },
            {
                name: "Alexandre Martin",
                age: 32,
                city: "Paris",
                image: "https://i.imgur.com/JL1pjI1.png",
                bio: "Future of Work & Digital Transformation",
                job: "Innovation Consultant",
                profileId: 5
            },
            {
                name: "Andrew Tate",
                age: 38,
                city: "Paris",
                image: "https://i.pinimg.com/736x/6a/dc/98/6adc983d2d137c6ba5d0b872a6418454.jpg",
                bio: "Masculine man",
                job: "Influencer",
                profileId: 2
            },
        ];

        // Purchase data
        const stores = [
            'Amazon', 'Fnac', 'Carrefour', 'Leclerc', 'Auchan', 'Monoprix', 'Galeries Lafayette',
            'Zara', 'H&M', 'Uniqlo', 'Sephora', 'D√©cathlon', 'Leroy Merlin', 'Ikea', 'Darty',
            'Boulanger', 'Micromania', 'Apple Store', 'Samsung Store', 'Nike', 'Adidas'
        ];

        // Safe products list
        const safeProducts = [
            { name: 'iPhone 15 Pro', icon: 'smartphone', price: [1000, 1200], category: 'Tech' },
            { name: 'MacBook Air M2', icon: 'laptop', price: [1200, 1500], category: 'Tech' },
            { name: 'AirPods Pro', icon: 'headphones', price: [250, 300], category: 'Audio' },
            { name: 'Nike Air Max', icon: 'zap', price: [120, 180], category: 'Fashion' },
            { name: 'Herm√®s Handbag', icon: 'shopping-bag', price: [800, 1500], category: 'Luxury' },
            { name: 'Chanel Perfume', icon: 'spray-can', price: [80, 150], category: 'Beauty' },
            { name: 'Apple Watch', icon: 'watch', price: [300, 500], category: 'Tech' },
            { name: 'Sony WH-1000XM4 Headphones', icon: 'headphones', price: [250, 350], category: 'Audio' },
            { name: 'iPad Pro', icon: 'tablet', price: [800, 1200], category: 'Tech' },
            { name: 'Console PS5', icon: 'gamepad-2', price: [500, 600], category: 'Gaming' },
            { name: 'Samsung 55" TV', icon: 'tv', price: [600, 1000], category: 'Electronics' },
            { name: 'Dyson Vacuum', icon: 'wind', price: [300, 500], category: 'Home' },
            { name: 'Nespresso Coffee Machine', icon: 'coffee', price: [150, 300], category: 'Kitchen' },
            { name: 'Electric Bike', icon: 'bike', price: [1000, 2000], category: 'Sports' },
            { name: 'Xiaomi Scooter', icon: 'zap', price: [300, 500], category: 'Mobility' },
            { name: 'Starbucks Coffee', icon: 'coffee', price: [5, 8], category: 'Food' },
            { name: 'Netflix Subscription', icon: 'tv', price: [10, 15], category: 'Entertainment' },
            { name: 'Gym Membership', icon: 'dumbbell', price: [30, 80], category: 'Sports' },
            { name: 'Spotify Premium', icon: 'music', price: [10, 12], category: 'Entertainment' },
            { name: 'Uber Ride', icon: 'car', price: [8, 25], category: 'Transport' }
        ];

        // Weird/awkward products list
        const weirdProducts = [
            { name: 'HIV Medication', icon: 'pill', price: [50, 200], category: 'Health' },
            { name: 'Political Donation', icon: 'vote', price: [25, 500], category: 'Politics' },
            { name: 'OnlyFans Subscription', icon: 'heart', price: [10, 50], category: 'Entertainment' },
            { name: 'How to Find Love by Eyal Kanaan', icon: 'book', price: [15, 30], category: 'Books' },
            { name: 'Adult Diapers', icon: 'package', price: [20, 40], category: 'Health' },
            { name: 'Hair Growth Pills', icon: 'pill', price: [30, 80], category: 'Health' },
            { name: 'Dating Coach Session', icon: 'users', price: [100, 300], category: 'Services' },
            { name: 'Crypto Investment Course', icon: 'bitcoin', price: [200, 1000], category: 'Education' },
            { name: 'Life Insurance', icon: 'shield', price: [50, 200], category: 'Insurance' },
            { name: 'Divorce Lawyer Consultation', icon: 'scale', price: [150, 500], category: 'Legal' },
            { name: 'Therapy Session', icon: 'brain', price: [80, 150], category: 'Health' },
            { name: 'Wedding Ring Return', icon: 'ring', price: [-2000, -500], category: 'Returns' },
            { name: 'Online Dating Premium', icon: 'heart', price: [20, 50], category: 'Dating' },
            { name: 'Bankruptcy Filing', icon: 'file-text', price: [200, 500], category: 'Legal' },
            { name: 'Weight Loss Pills', icon: 'pill', price: [40, 100], category: 'Health' },
            { name: 'Ex-Girlfriend Gift Return', icon: 'gift', price: [-100, -50], category: 'Returns' },
            { name: 'Tinder Gold Subscription', icon: 'heart', price: [15, 30], category: 'Dating' },
            { name: 'Job Interview Coaching', icon: 'briefcase', price: [100, 300], category: 'Services' },
        ];

        // Specific products for each profile (fixed, no random)
        const specificProducts = {
            1: [ // Sylvain Bureau
                { name: 'White Night by Dostoyevsky', icon: 'book', price: 15, category: 'Books', store: 'Fnac', date: '15/03/2024' }
            ],
            2: [ // Andrew Tate
                { name: 'OF Subscription', icon: 'heart', price: 35, category: 'Explicit', store: 'OnlyFans', date: '10/02/2024' },
                { name: 'Alpha Men by Daniel A', icon: 'book', price: 25, category: 'Books', store: 'Amazon', date: '22/01/2024' },
                { name: 'Lamborghini Hurac√°n', icon: 'car', price: 225000, category: 'Luxury', store: 'Lamborghini Paris', date: '05/12/2023' }
            ],
            3: [ // Mia Khalifa
                { name: 'Herm√®s Birkin Bag', icon: 'shopping-bag', price: 17500, category: 'Luxury', store: 'Herm√®s', date: '03/10/2023' },
                { name: 'Porsche 911', icon: 'car', price: 125000, category: 'Luxury', store: 'Porsche Center', date: '14/09/2023' },
                { name: 'Prada Dress', icon: 'shirt', price: 2500, category: 'Fashion', store: 'Prada', date: '28/08/2023' },
            ],
            4: [ // Marie Dubois
                { name: 'Long Coat', icon: 'users', price: 600, category: 'Fashion', store: 'COS', date: '12/03/2024' },
                { name: 'Adobe Creative Suite', icon: 'palette', price: 455.99, category: 'Software', store: 'Adobe', date: '05/02/2024' },
                { name: 'MacBook Pro M3', icon: 'laptop', price: 2800, category: 'Tech', store: 'Apple Store', date: '20/01/2024' },
                { name: 'Innovation Books Bundle', icon: 'book', price: 120, category: 'Books', store: 'Fnac', date: '15/12/2023' }
            ],
            5: [ // Alexandre Martin
                { name: 'Digital Transformation Course', icon: 'graduation-cap', price: 1200, category: 'Education', store: 'Coursera', date: '08/03/2024' },
                { name: 'NY Times Subscription', icon: 'monitor', price: 30, category: 'Office', store: 'Oshop', date: '22/02/2024' },
                { name: 'Noise-Cancelling Headphones', icon: 'headphones', price: 350, category: 'Audio', store: 'Bose', date: '10/01/2024' },
                { name: 'Future of Work Conference', icon: 'users', price: 750, category: 'Events', store: 'Eventbrite', date: '05/12/2023' }
            ]
        };

        // App state
        let currentProfileIndex = 0;
        let stats = { likes: 0, passes: 0, views: 0 };
        let isCustomUpload = false;
        let uploadedImageData = null;

        // Audio context for sound effects
        let audioContext = null;
        let cashSound = null;
        let loserSound = null;

        // Initialize app
        function initApp() {
            loadNextProfile();
            updateStats();
            initAudio();
        }

        // Initialize audio context
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                // Charger les sons MP3
                loadCashSound();
                loadLoserSound();
            } catch (e) {
                console.log('Web Audio API not supported');
            }
        }

        // Charger le fichier MP3
        function loadCashSound() {
            cashSound = new Audio();
            cashSound.src = 'cash.mp3'; // Remplacez par votre URL
            cashSound.preload = 'auto';
            cashSound.volume = 0.5; // Volume √† 50%
            
            // G√©rer les erreurs de chargement
            cashSound.addEventListener('error', (e) => {
                console.log('Error loading sound:', e);
            });
        }

        // Charger le son de loser
        function loadLoserSound() {
            loserSound = new Audio();
            loserSound.src = 'loser.mp3'; // Remplacez par votre URL
            loserSound.preload = 'auto';
            loserSound.volume = 0.6; // Volume √† 60%
            
            // G√©rer les erreurs de chargement
            loserSound.addEventListener('error', (e) => {
                console.log('Error loading loser sound:', e);
            });
        }

        // Play cash sound effect from MP3
        function playCashSound() {
            if (!cashSound) return;
            
            // Remettre le son au d√©but et le jouer
            cashSound.currentTime = 0;
            cashSound.play().catch(e => {
                console.log('Error playing sound:', e);
            });
        }

        // Play loser sound effect from MP3
        function playLoserSound() {
            if (!loserSound) return;
            
            // Remettre le son au d√©but et le jouer
            loserSound.currentTime = 0;
            loserSound.play().catch(e => {
                console.log('Error playing loser sound:', e);
            });
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function checkIfHighSpender(profileId) {
            if (!profileId || !specificProducts[profileId]) return false;
            const totalSpent = specificProducts[profileId].reduce((sum, product) => sum + product.price, 0);
            return totalSpent > 100000;
        }

        function createProfileCard(profile, index) {
            const card = document.createElement('div');
            card.className = 'swipe-card';
            card.style.zIndex = 1000 - index;
            card.style.transform = 'translateX(0) rotate(0deg)';
            card.style.opacity = '1';
            
            // V√©rifier si c'est un gros d√©pensier
            const isHighSpender = checkIfHighSpender(profile.profileId);
            
            // Animation d'apparition seulement pour la premi√®re carte
            // if (index === 0) {
            //     card.style.transform = 'translateX(0) rotate(0deg) scale(0.9) translateY(20px)';
            //     card.style.opacity = '0';
                
            //     // Forcer le reflow
            //     card.offsetHeight;
                
            //     // Animation d'entr√©e
            //     requestAnimationFrame(() => {
            //         card.style.transition = 'transform 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
            //         card.style.transform = 'translateX(0) rotate(0deg) scale(1) translateY(0)';
            //         card.style.opacity = '1';
                    
            //         setTimeout(() => {
            //             card.style.transition = '';
            //         }, 500);
            //     });
            // } else {
            //     // Les cartes suivantes n'ont pas d'animation d'apparition
            //     card.style.transform = 'translateX(0) rotate(0deg) scale(1) translateY(0)';
            //     card.style.opacity = '1';
            // }
            
            card.innerHTML = `
                <div class="relative h-full profile-image" style="background-image: url('${profile.image}')">
                    <div class="absolute inset-0 gradient-overlay"></div>
                    ${isHighSpender ? '<div class="absolute top-4 left-4 bg-gradient-to-r from-yellow-400 to-yellow-600 text-black px-3 py-1 rounded-full text-sm font-bold shadow-lg high-spender-badge">üí∞ HIGH SPENDER</div>' : ''}
                    <div class="absolute bottom-0 left-0 right-0 p-8 text-white">
                        <h3 class="text-3xl font-bold mb-2">${profile.name}</h3>
                        <p class="text-xl opacity-90 mb-3">${profile.age} years old ‚Ä¢ ${profile.city}</p>
                        <p class="opacity-80 mb-2 text-lg">${profile.job}</p>
                        <p class="text-base opacity-70">${profile.bio}</p>
                    </div>
                </div>
            `;

            addSwipeListeners(card, index);
            return card;
        }

        function loadNextProfile() {
            const container = document.getElementById('swipeContainer');
            container.innerHTML = '';
            
            // Charger les profils normaux
            for (let i = 0; i < 3 && currentProfileIndex + i < profiles.length; i++) {
                const profile = profiles[currentProfileIndex + i];
                const card = createProfileCard(profile, i);
                container.appendChild(card);
                
                // Animation d'apparition seulement pour la premi√®re carte
                if (i === 0) {
                    // La premi√®re carte a d√©j√† son animation dans createProfileCard
                } else {
                    // Les cartes suivantes apparaissent imm√©diatement sans animation
                    card.style.transform = 'translateX(0) rotate(0deg) scale(1) translateY(0)';
                    card.style.opacity = '1';
                }
            }
            
            lucide.createIcons();
        }

        function createUploadCard() {
            const card = document.createElement('div');
            card.className = 'swipe-card';
            card.style.zIndex = 1000;
            card.style.transform = 'translateX(0) rotate(0deg) scale(0.9) translateY(20px)';
            card.style.opacity = '0';
            
            card.innerHTML = `
                <div class="relative h-full profile-image" style="background-image: url('${uploadedImageData}')">
                    <div class="absolute inset-0 gradient-overlay"></div>
                    <div class="absolute bottom-0 left-0 right-0 p-8 text-white">
                        <h3 class="text-3xl font-bold mb-2">Uploaded Photo</h3>
                        <p class="text-xl opacity-90 mb-3">AI Analysis in progress...</p>
                        <p class="opacity-80 mb-2 text-lg">Custom profile</p>
                        <p class="text-base opacity-70">Discover the purchase history generated by our AI</p>
                    </div>
                    <div class="absolute top-6 right-6">
                        <button onclick="showUploadHistory()" class="bg-white/20 backdrop-blur-md rounded-full p-3 hover:bg-white/30 transition-all duration-200">
                            <i data-lucide="info" class="w-6 h-6 text-white"></i>
                        </button>
                    </div>
                </div>
            `;

            // Forcer le reflow
            card.offsetHeight;
            
            // Animation d'entr√©e
            requestAnimationFrame(() => {
                card.style.transition = 'transform 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
                card.style.transform = 'translateX(0) rotate(0deg) scale(1) translateY(0)';
                card.style.opacity = '1';
                
                setTimeout(() => {
                    card.style.transition = 'none';
                }, 500);
            });

            addSwipeListeners(card, -1);
            return card;
        }

        function addSwipeListeners(card, index) {
            let startX = 0;
            let startY = 0;
            let currentX = 0;
            let currentY = 0;
            let isDragging = false;
            let animationFrame = null;

            // Mouse events
            card.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', endDrag);

            // Touch events
            card.addEventListener('touchstart', startDrag, { passive: false });
            document.addEventListener('touchmove', drag, { passive: false });
            document.addEventListener('touchend', endDrag);

            function startDrag(e) {
                isDragging = true;
                card.classList.add('dragging');
                
                const clientX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
                const clientY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY;
                
                startX = clientX;
                startY = clientY;
                currentX = 0;
                currentY = 0;
            }

            function drag(e) {
                if (!isDragging) return;
                e.preventDefault();
                
                const clientX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
                const clientY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
                
                const newX = clientX - startX;
                const newY = clientY - startY;
                
                // Only update if there's a significant change
                if (Math.abs(newX - currentX) > 2 || Math.abs(newY - currentY) > 2) {
                    currentX = newX;
                    currentY = newY;
                    
                    // Cancel previous animation frame
                    if (animationFrame) {
                        cancelAnimationFrame(animationFrame);
                    }
                    
                    // Only allow horizontal swiping
                    if (Math.abs(currentX) > Math.abs(currentY)) {
                        animationFrame = requestAnimationFrame(() => {
                            const rotation = currentX * 0.08;
                            const opacity = Math.max(0.3, 1 - Math.abs(currentX) / 250);
                            
                            card.style.transform = `translateX(${currentX}px) rotate(${rotation}deg) scale(1)`;
                            card.style.opacity = opacity;
                        });
                    }
                }
            }

            function endDrag(e) {
                if (!isDragging) return;
                isDragging = false;
                card.classList.remove('dragging');
                
                // Cancel any pending animation
                if (animationFrame) {
                    cancelAnimationFrame(animationFrame);
                    animationFrame = null;
                }
                
                const threshold = 60;
                
                if (Math.abs(currentX) > threshold && Math.abs(currentX) > Math.abs(currentY)) {
                    if (currentX > 0) {
                        swipeRight();
                    } else {
                        swipeLeft();
                    }
                } else {
                    // Return to center with smooth animation
                    card.style.transition = 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
                    card.style.transform = 'translateX(0) rotate(0deg) scale(1)';
                    card.style.opacity = '1';
                    
                    setTimeout(() => {
                        card.style.transition = 'none';
                    }, 300);
                }
                
                currentX = 0;
                currentY = 0;
            }
        }

        function swipeLeft() {
            const cards = document.querySelectorAll('.swipe-card');
            if (cards.length === 0) return;
            
            const topCard = cards[0];
            topCard.classList.add('swiped-left');
            stats.passes++;
            updateStats();
            
            // Play loser sound effect
            playLoserSound();
            
            // Attendre la fin de l'animation avant de charger le suivant
            setTimeout(() => {
                if (uploadedImageData) {
                    uploadedImageData = null;
                    loadNextProfile();
                } else {
                    nextProfile();
                }
            }, 400);
        }

        function swipeRight() {
            const cards = document.querySelectorAll('.swipe-card');
            if (cards.length === 0) return;
            
            const topCard = cards[0];
            topCard.classList.add('swiped-right');
            stats.likes++;
            updateStats();
            
            // Play cash sound effect
            playCashSound();
            
            // Afficher l'animation de match
            
            // Attendre la fin de l'animation avant de charger le suivant
            setTimeout(() => {
                if (uploadedImageData) {
                    uploadedImageData = null;
                    loadNextProfile();
                } else {
                    nextProfile();
                }
            }, 400);
        }

        function showMatchAnimation() {
            // Cr√©er l'√©l√©ment d'animation de match
            const matchDiv = document.createElement('div');
            matchDiv.className = 'match-animation';
            
            // Messages de match al√©atoires
            const matchMessages = [
                "It's a Match! üíï",
                "You liked each other! ‚ù§Ô∏è",
                "Perfect Match! üíñ",
                "Love at first swipe! üíò",
                "You're a match! üíù",
                "Mutual attraction! üíï"
            ];
            
            const randomMessage = matchMessages[Math.floor(Math.random() * matchMessages.length)];
            
            matchDiv.innerHTML = `
                <div class="match-heart">
                    <i data-lucide="heart" class="w-12 h-12"></i>
                </div>
                <div class="match-text">${randomMessage}</div>
            `;
            
            // Ajouter au body
            document.body.appendChild(matchDiv);
            
            // Initialiser les ic√¥nes Lucide
            lucide.createIcons();
            
            // Supprimer l'animation apr√®s 2.5 secondes
            setTimeout(() => {
                if (matchDiv.parentNode) {
                    matchDiv.parentNode.removeChild(matchDiv);
                }
            }, 2500);
        }

        function nextProfile() {
            currentProfileIndex++;
            if (currentProfileIndex >= profiles.length) {
                currentProfileIndex = 0;
            }
            loadNextProfile();
        }

        function showCurrentProfile() {
            showProfileHistory(0);
        }

        function showProfileHistory(cardIndex) {
            stats.views++;
            updateStats();
            
            const profile = profiles[currentProfileIndex + cardIndex];
            const purchases = generatePurchaseHistory(profile.profileId);
            showProfileModal(profile, purchases);
        }

        function showUploadHistory() {
            stats.views++;
            updateStats();
            
            const fakeProfile = {
                name: "Analyzed Profile",
                age: Math.floor(Math.random() * 15) + 25,
                city: "France",
                job: "AI Analysis"
            };
            
            const purchases = generatePurchaseHistory();
            showProfileModal(fakeProfile, purchases, true);
        }

        function generatePurchaseHistory(profileId = null) {
            const purchases = [];
            let totalSpent = 0;
            
            // Ajouter les achats sp√©cifiques du profil en premier
            if (profileId && specificProducts[profileId]) {
                specificProducts[profileId].forEach(product => {
                    // Utiliser les donn√©es fixes du produit (prix, magasin, date)
                    const productData = {
                        name: product.name,
                        icon: product.icon,
                        category: product.category
                    };
                    
                    totalSpent += product.price;
                    purchases.push({ 
                        product: productData, 
                        store: product.store, 
                        price: product.price, 
                        date: product.date 
                    });
                });
            }
            
            // Ajouter des achats al√©atoires pour compl√©ter jusqu'√† 4 √©l√©ments
            const remainingSlots = 4 - purchases.length;
            for (let i = 0; i < remainingSlots; i++) {
                const product = safeProducts[Math.floor(Math.random() * safeProducts.length)];
                const store = stores[Math.floor(Math.random() * stores.length)];
                const price = Math.floor(Math.random() * (product.price[1] - product.price[0]) + product.price[0]);
                const date = generateRandomDate();
                
                totalSpent += price;
                purchases.push({ product, store, price, date });
            }

            return { purchases, totalSpent };
        }

        function generateRandomDate() {
            const now = new Date();
            const pastYear = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
            const randomTime = pastYear.getTime() + Math.random() * (now.getTime() - pastYear.getTime());
            const randomDate = new Date(randomTime);
            
            return randomDate.toLocaleDateString('fr-FR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }

        function showProfileModal(profile, purchaseData, isUpload = false) {
            const modal = document.getElementById('profileModal');
            const content = document.getElementById('profileContent');
            
            // Masquer les cartes de swipe
            const swipeCards = document.querySelectorAll('.swipe-card');
            swipeCards.forEach(card => card.classList.add('hidden'));
            
            content.innerHTML = `
                <div class="mb-8">
                    <div class="flex items-center space-x-6 mb-6">
                        <div class="w-20 h-20 bg-gradient-to-br from-red-500 to-pink-500 rounded-2xl flex items-center justify-center text-white text-2xl font-bold shadow-lg">
                            ${profile.name.split(' ').map(n => n[0]).join('')}
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold">${profile.name}</h3>
                            <p class="text-gray-600 text-lg">${profile.age} years old ‚Ä¢ ${profile.city}</p>
                            <p class="text-sm text-gray-500 font-medium">${profile.job}</p>
                        </div>
                    </div>
                    ${isUpload ? '<div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6"><p class="text-blue-800 text-sm font-medium"><i data-lucide="info" class="w-4 h-4 inline mr-2"></i> History generated by AI from your photo</p></div>' : ''}
                </div>

                <div class="bg-gray-50 rounded-xl p-4 mb-6">
                    <h4 class="font-bold text-lg mb-3 flex items-center">
                        <i data-lucide="receipt" class="w-6 h-6 mr-3 text-red-500"></i>
                        Purchase History (${purchaseData.purchases.length} purchases)
                    </h4>
                    <div class="space-y-3">
                        ${purchaseData.purchases.map(purchase => `
                            <div class="purchase-item flex items-center justify-between bg-white p-3 rounded-xl shadow-sm">
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 bg-gradient-to-br from-red-100 to-pink-100 rounded-xl flex items-center justify-center">
                                        <i data-lucide="${purchase.product.icon}" class="w-6 h-6 text-red-500"></i>
                                    </div>
                                    <div>
                                        <p class="font-semibold text-base">${purchase.product.name}</p>
                                        <p class="text-sm text-gray-500">${purchase.store} ‚Ä¢ ${purchase.date}</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="font-bold text-lg text-red-500">${purchase.price}‚Ç¨</p>
                                    <span class="category-badge">${purchase.product.category}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="total-card rounded-2xl p-6 text-center shadow-lg ${purchaseData.totalSpent > 100000 ? 'high-spender' : ''}">
                    <p class="${purchaseData.totalSpent > 100000 ? 'text-black/80' : 'text-white/90'} text-lg mb-2 font-medium">Total spent (last month)</p>
                    <p class="text-4xl font-bold ${purchaseData.totalSpent > 100000 ? 'text-black' : 'text-white'}">${purchaseData.totalSpent.toLocaleString()}‚Ç¨</p>
                    ${purchaseData.totalSpent > 100000 ? '<p class="text-black/70 text-sm mt-2 font-semibold">üí∞ HIGH SPENDER DETECTED! üí∞</p>' : ''}
                </div>
            `;
            
            modal.classList.remove('hidden');
            lucide.createIcons();
        }

        function closeProfileModal() {
            document.getElementById('profileModal').classList.add('hidden');
            
            // R√©afficher les cartes de swipe
            const swipeCards = document.querySelectorAll('.swipe-card');
            swipeCards.forEach(card => card.classList.remove('hidden'));
        }

        function showUploadModal() {
            document.getElementById('uploadModal').classList.remove('hidden');
        }

        function closeUploadModal() {
            document.getElementById('uploadModal').classList.add('hidden');
        }

        function updateStats() {
            document.getElementById('likesCount').textContent = stats.likes;
            document.getElementById('passesCount').textContent = stats.passes;
            document.getElementById('viewsCount').textContent = stats.views;
        }

        // Upload functionality
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const analyzeUploadBtn = document.getElementById('analyzeUploadBtn');

        uploadArea.addEventListener('click', () => fileInput.click());

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleUploadFile(e.target.files[0]);
            }
        });

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleUploadFile(files[0]);
            }
        });

        function handleUploadFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('Please select an image file.');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                uploadedImageData = e.target.result;
                analyzeUploadBtn.classList.remove('hidden');
                uploadArea.innerHTML = `
                    <img src="${uploadedImageData}" class="max-h-40 mx-auto rounded-xl mb-4 shadow-lg">
                    <p class="text-green-600 font-semibold text-lg">Photo uploaded successfully!</p>
                `;
            };
            reader.readAsDataURL(file);
        }

        analyzeUploadBtn.addEventListener('click', () => {
            closeUploadModal();
            loadUploadedPhoto();
        });

        function loadUploadedPhoto() {
            const container = document.getElementById('swipeContainer');
            container.innerHTML = '';
            
            const uploadCard = createUploadCard();
            container.appendChild(uploadCard);
            
            lucide.createIcons();
        }

        // Initialize app
        initApp();
    </script>
</body>
</html>